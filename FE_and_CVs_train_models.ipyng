{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "18bfef74-cfff-4649-afed-e7a9a7dbf628",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2025-02-25 11:46:31.719368: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n",
      "To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n"
     ]
    }
   ],
   "source": [
    "from scipy.stats import gaussian_kde\n",
    "import numpy as np\n",
    "import tensorflow as tf\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "import matplotlib.pyplot as plt\n",
    "import scipy.ndimage as ndimage\n",
    "import scipy.signal\n",
    "from tensorflow.keras.models import load_model\n",
    "import warnings\n",
    "\n",
    "warnings.filterwarnings(\"ignore\")\n",
    "\n",
    "from matplotlib import rc\n",
    "plt.rcParams.update({ \"text.usetex\": True, \"font.family\": \"serif\", \"font.serif\": [\"computer modern roman\"], \"font.size\": 18})\n",
    "plw = 0.6\n",
    "pcs = 3\n",
    "pms = 3\n",
    "bfillc = [0.9,0.9,0.9]\n",
    "plt.rcParams['axes.linewidth'] = plw\n",
    "plt.rcParams['xtick.top'] = True\n",
    "plt.rcParams['xtick.direction'] = 'in'\n",
    "plt.rcParams['xtick.major.width'] = plw\n",
    "plt.rcParams['xtick.minor.width'] = plw\n",
    "plt.rcParams['xtick.minor.visible'] = True\n",
    "plt.rcParams['xtick.major.size'] = 4.5\n",
    "plt.rcParams['ytick.right'] = True\n",
    "plt.rcParams['ytick.direction'] = 'in'\n",
    "plt.rcParams['ytick.major.width'] = plw\n",
    "plt.rcParams['ytick.minor.width'] = plw\n",
    "plt.rcParams['ytick.minor.visible'] = True\n",
    "plt.rcParams['ytick.major.size'] = 5\n",
    "plt.rcParams[\"figure.figsize\"] = (5,4)\n",
    "\n",
    "\n",
    "\n",
    "# define custom color scheme\n",
    "colors = [plt.cm.Spectral(i/float(20-1)) for i in range(20)]\n",
    "\n",
    "#for i in range(10):\n",
    "#    plt.scatter(i, i, color=colors[i], s=500)\n",
    "\n",
    "cs = {\n",
    "    \"Bordeaux\": colors[0],\n",
    "    \"Light Red\": colors[1],\n",
    "    \"Orange\": colors[2],\n",
    "    \"Gold\": colors[3],\n",
    "    \"Yellow\": colors[4],\n",
    "    \"Lime\": colors[5],\n",
    "    \"Light Green\": colors[6],\n",
    "    \"Teal\": colors[7],\n",
    "    \"Blue\": colors[8],\n",
    "    \"Purple\": colors[9]\n",
    "}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "71e9c2f0-3e01-4e3e-a241-8f1cc40defe2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Set random seeds for reproducibility\n",
    "np.random.seed(42)\n",
    "tf.random.set_seed(42)\n",
    "\n",
    "# Set dimensionality of configurational space \n",
    "ND=100\n",
    "\n",
    "# Generate clustered data\n",
    "def generate_clustered_data(n_samples=1200):\n",
    "    # Create three clusters in ND space\n",
    "    centers = [\n",
    "        np.random.normal(0, 1, ND),\n",
    "        np.random.normal(1, 2, ND),\n",
    "        np.random.normal(-2, 3, ND),\n",
    "        np.random.normal(-3, 1, ND),\n",
    "    ]\n",
    "    \n",
    "    data = []\n",
    "    for center in centers:\n",
    "        #cluster = np.random.normal(center, 1, (n_samples //  np.random.randint(2, 10+1),  ND))\n",
    "        cluster = np.random.normal(center, 4, (n_samples //  4,  ND))\n",
    "        data.append(cluster)\n",
    "        #background = np.random.uniform(center, 1, (n_samples // 20 ,  ND))\n",
    "        #data.append(background)\n",
    "        \n",
    "    return np.vstack(data)\n",
    "\n",
    "# Create and train the autoencoder\n",
    "def create_autoencoder(input_dim=ND, encoding_dim=2):\n",
    "    # Encoder\n",
    "    encoder_input = tf.keras.Input(shape=(input_dim,))\n",
    "    encoder_hidden1 = tf.keras.layers.Dense(16, activation='tanh')(encoder_input)  # More neurons\n",
    "    #encoder_hidden2 = tf.keras.layers.Dense(8, activation='tanh')(encoder_hidden1)  # Extra layer\n",
    "    encoder_output = tf.keras.layers.Dense(encoding_dim)(encoder_hidden1)  # Bottleneck layer\n",
    "    \n",
    "    # Decoder\n",
    "    decoder_hidden1 = tf.keras.layers.Dense(16, activation='tanh')(encoder_output)  # Extra layer\n",
    "    #decoder_hidden2 = tf.keras.layers.Dense(16, activation='tanh')(decoder_hidden1)  # More neurons\n",
    "    decoder_output = tf.keras.layers.Dense(input_dim)(decoder_hidden1)  # Output layer\n",
    "    \n",
    "    # Full autoencoder model\n",
    "    autoencoder = tf.keras.Model(encoder_input, decoder_output)\n",
    "    \n",
    "    # Separate encoder\n",
    "    encoder = tf.keras.Model(encoder_input, encoder_output)\n",
    "    \n",
    "    return autoencoder, encoder\n",
    "\n",
    "# Compute Jacobian for a given input point\n",
    "def compute_jacobian(encoder, input_point):\n",
    "    input_point = tf.cast(input_point, tf.float32)\n",
    "    input_point = tf.reshape(input_point, (1, -1))\n",
    "    \n",
    "    with tf.GradientTape(persistent=True) as tape:\n",
    "        tape.watch(input_point)\n",
    "        output = encoder(input_point)\n",
    "    \n",
    "    # Initialize Jacobian matrix\n",
    "    jacobian = np.zeros((2, ND))  # 2×10 matrix for our case\n",
    "    \n",
    "    # Compute gradients for each output dimension\n",
    "    for i in range(2):\n",
    "        grads = tape.gradient(output[:, i], input_point)\n",
    "        if grads is not None:\n",
    "            jacobian[i] = grads.numpy()\n",
    "    \n",
    "    return jacobian\n",
    "\n",
    "\n",
    "def weight_space_distance(model1, model2, method='euclidean'):\n",
    "    \"\"\"\n",
    "    Compute the distance between two models in the weight space.\n",
    "    \n",
    "    Args:\n",
    "        model1: First TensorFlow model\n",
    "        model2: Second TensorFlow model\n",
    "        method: Distance metric ('euclidean', 'cosine', 'l1', 'l2')\n",
    "    \n",
    "    Returns:\n",
    "        Distance value\n",
    "    \"\"\"\n",
    "    # Get weights as flattened arrays\n",
    "    weights1 = np.concatenate([w.numpy().flatten() for w in model1.weights])\n",
    "    weights2 = np.concatenate([w.numpy().flatten() for w in model2.weights])\n",
    "    \n",
    "    if method == 'euclidean' or method == 'l2':\n",
    "        return np.sqrt(np.sum((weights1 - weights2)**2))\n",
    "    \n",
    "    elif method == 'l1':\n",
    "        return np.sum(np.abs(weights1 - weights2))\n",
    "    \n",
    "    elif method == 'cosine':\n",
    "        dot_product = np.dot(weights1, weights2)\n",
    "        norm1 = np.linalg.norm(weights1)\n",
    "        norm2 = np.linalg.norm(weights2)\n",
    "        return 1 - (dot_product / (norm1 * norm2))\n",
    "    \n",
    "    elif method == 'normalized_euclidean':\n",
    "        # Scale by weight magnitudes to reduce impact of large weights\n",
    "        return np.sqrt(np.sum(((weights1 - weights2) / (np.abs(weights1) + np.abs(weights2) + 1e-9))**2))\n",
    "    \n",
    "    elif method == 'layer_wise':\n",
    "        # Compute distance layer by layer\n",
    "        distances = []\n",
    "        for w1, w2 in zip(model1.weights, model2.weights):\n",
    "            w1_flat = w1.numpy().flatten()\n",
    "            w2_flat = w2.numpy().flatten()\n",
    "            distances.append(np.sqrt(np.sum((w1_flat - w2_flat)**2)))\n",
    "        return distances\n",
    "    \n",
    "    else:\n",
    "        raise ValueError(f\"Unknown distance method: {method}\")\n",
    "\n",
    "\n",
    "\n",
    "filename_test='histogram_relu_8neurons_1layer_100D_width4_1200pts.png'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c6443e85-960f-4d8b-9ff9-a1465c16921b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Generate data\n",
    "data = generate_clustered_data()\n",
    "\n",
    "# Standardize the data\n",
    "scaler = StandardScaler()\n",
    "data_scaled = scaler.fit_transform(data).astype(np.float32)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "50c7ca0c-f3b9-4d86-b9d4-be57bb192140",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  0\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 507us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  1\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 950us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 660us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  2\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 946us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 511us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  3\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 902us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 551us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  4\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 972us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 626us/step\n",
      "WARNING:tensorflow:5 out of the last 5 calls to <function pfor.<locals>.f at 0x1b253eac0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:5 out of the last 5 calls to <function pfor.<locals>.f at 0x1b253eac0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.\n",
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  5\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 645us/step\n",
      "WARNING:tensorflow:6 out of the last 6 calls to <function pfor.<locals>.f at 0x1b2458860> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:tensorflow:6 out of the last 6 calls to <function pfor.<locals>.f at 0x1b2458860> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.\n",
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  6\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 519us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  7\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 937us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 521us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  8\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 933us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 495us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  9\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 883us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 550us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  10\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 901us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 542us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  11\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 887us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 566us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  12\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 909us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 520us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  13\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 928us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 533us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  14\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 935us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 502us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  15\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 925us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 579us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  16\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 946us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 574us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  17\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 895us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 511us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  18\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 910us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 541us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  19\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 922us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 538us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  20\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 906us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 587us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  21\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 928us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 498us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  22\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 916us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 557us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  23\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 897us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 522us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  24\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 902us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 523us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  25\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 915us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 553us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  26\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 918us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 520us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  27\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 907us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 524us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  28\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 926us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 554us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  29\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 905us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 559us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  30\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 974us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 541us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  31\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 530us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  32\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 919us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 558us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  33\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 907us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 503us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  34\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 927us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 518us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  35\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 907us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 605us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  36\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 952us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 510us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  37\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 981us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 515us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  38\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 942us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 539us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  39\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 940us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 547us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  40\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 871us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 555us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  41\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 925us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 534us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  42\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 953us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 618us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  43\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 940us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 515us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  44\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 947us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 853us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  45\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 923us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 539us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  46\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 898us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 525us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  47\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 890us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 549us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  48\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 881us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 523us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  49\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 938us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 510us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  50\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 891us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 525us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  51\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 932us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 547us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  52\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 927us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 522us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  53\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 965us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 549us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  54\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 905us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 567us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  55\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 993us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 575us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  56\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 907us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 569us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  57\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 937us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 576us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  58\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 974us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 692us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  59\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 891us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 539us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  60\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 916us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 532us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  61\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 912us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 687us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  62\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 620us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  63\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 929us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 512us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  64\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 977us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 590us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  65\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 903us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 559us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  66\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 995us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 558us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  67\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 910us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 514us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  68\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 919us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 739us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  69\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 542us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  70\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 989us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 648us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  71\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 539us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  72\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 609us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  73\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 945us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 637us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  74\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 582us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  75\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 593us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  76\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 636us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  77\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 577us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  78\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 594us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  79\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 2ms/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 559us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  80\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 606us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  81\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 615us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  82\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 914us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 585us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  83\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 992us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 597us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  84\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 603us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  85\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 968us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 585us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  86\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 998us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 570us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  87\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 802us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  88\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 777us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  89\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 866us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  90\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 964us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 636us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  91\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 635us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  92\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 630us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  93\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 615us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  94\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 648us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  95\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 590us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  96\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 690us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  97\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 649us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  98\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 988us/step\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 564us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model  99\n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 1ms/step \n",
      "\u001b[1m38/38\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 617us/step\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. \n"
     ]
    }
   ],
   "source": [
    "niter=0\n",
    "deltas_FG=[]\n",
    "deltas_F=[]\n",
    "\n",
    "while niter<100: \n",
    "\n",
    "    print(\"Model \",niter)\n",
    "    \n",
    "    # Create and compile the autoencoder\n",
    "    autoencoder, encoder = create_autoencoder()\n",
    "    autoencoder.compile(optimizer='adam', loss='mse')\n",
    "    \n",
    "    # Train the autoencoder\n",
    "    history = autoencoder.fit(\n",
    "        data_scaled, \n",
    "        data_scaled,\n",
    "        epochs=100,\n",
    "        batch_size=100,\n",
    "        shuffle=True,\n",
    "        verbose=0\n",
    "    )\n",
    "\n",
    "    # Encode the data to 2D\n",
    "    encoded_data = encoder.predict(data_scaled)\n",
    "    \n",
    "    # Compute Jacobian at several points\n",
    "    sample_points = data_scaled[::1]  # Take every 50th point\n",
    "    jacobians = np.array([compute_jacobian(encoder, point) for point in sample_points])\n",
    "    \n",
    "    # Encode the data to 2D\n",
    "    encoded_data = encoder.predict(data_scaled)\n",
    "\n",
    "    sample_points = data_scaled[::1]  # Take every datapoint\n",
    "\n",
    "    # Jacobian: Inefficient but I know what it's doing\n",
    "    #i=0\n",
    "    #w_g=np.zeros(np.shape(sample_points)[0])\n",
    "    #for point in sample_points:        \n",
    "    #    x = tf.reshape(tf.convert_to_tensor(point),(1, ND))\n",
    "    #    \n",
    "    #    # Compute the Jacobian using tf.GradientTape\n",
    "    #    with tf.GradientTape() as tape:\n",
    "    #        tape.watch(x)\n",
    "    #        encoded_output = encoder(x)  # Forward pass through encoder\n",
    "    #    \n",
    "    #    jacobian = tape.jacobian(encoded_output, x).numpy().squeeze() \n",
    "    #    singular_values = np.linalg.svd(jacobian, compute_uv=False)\n",
    "    #    w_g[int(i)] = np.prod(singular_values)\n",
    "    #    print(w_g[i])\n",
    "    #    i=i+1\n",
    "    \n",
    "    # Jacobian using tensorflow black magic\n",
    "    # Convert all points to tensor at once\n",
    "    x_batch = tf.convert_to_tensor(sample_points, dtype=tf.float32)\n",
    "    \n",
    "    # Compute Jacobian for entire batch\n",
    "    with tf.GradientTape() as tape:\n",
    "        tape.watch(x_batch)\n",
    "        encoded_output = encoder(x_batch)\n",
    "    \n",
    "    # Get Jacobian for all points at once\n",
    "    batch_jacobian = tape.jacobian(encoded_output, x_batch)\n",
    "    \n",
    "    # Extract just the correct Jacobian for each point using tf.linalg.diag_part\n",
    "    batch_size = x_batch.shape[0]\n",
    "    jacobians = tf.zeros((batch_size, 2, ND))\n",
    "    for i in range(batch_size):\n",
    "        jacobians = tf.tensor_scatter_nd_update(\n",
    "            jacobians,\n",
    "            [[i]],\n",
    "            [batch_jacobian[i, :, i, :]]\n",
    "        )\n",
    "    \n",
    "    # Compute SVD for all Jacobians at once\n",
    "    s = tf.linalg.svd(jacobians, compute_uv=False)\n",
    "\n",
    "    # Compute product of singular values for each point\n",
    "    w_g = tf.reduce_prod(s, axis=1).numpy() + 1E-20\n",
    "\n",
    "    # First, let's get the range of our encoded data\n",
    "    x_min, x_max = encoded_data[:, 0].min(), encoded_data[:, 0].max()\n",
    "    y_min, y_max = encoded_data[:, 1].min(), encoded_data[:, 1].max()\n",
    "\n",
    "    # Scatter plot\n",
    "    #plt.subplot(1, 4, 2)\n",
    "    #plt.scatter(encoded_data[:, 0], encoded_data[:, 1], c=colors[0], alpha=0.5, s=2)\n",
    "    #plt.title('Encoded Data')\n",
    "    #plt.xlabel('$s_1$')\n",
    "    #plt.ylabel('$s_2$')\n",
    "    \n",
    "    # Assume encoded_data contains two columns: s1 and s2\n",
    "    s1, s2 = encoded_data[:, 0], encoded_data[:, 1]\n",
    "    \n",
    "    # Compute weighted KDE\n",
    "    values = np.vstack([s1, s2])  # Stack into 2D array\n",
    "    kde = gaussian_kde(values, weights=w_g)  # Apply weights\n",
    "    kde.set_bandwidth(bw_method=kde.factor * 0.5)\n",
    "    kde_uw = gaussian_kde(values)  # unweighted\n",
    "    kde_uw.set_bandwidth(bw_method=kde_uw.factor * 0.5)\n",
    "    \n",
    "    # Create a grid for evaluation\n",
    "    x_grid = np.linspace(x_min, x_max, 100)\n",
    "    y_grid = np.linspace(y_min, y_max, 100)\n",
    "    X, Y = np.meshgrid(x_grid, y_grid)\n",
    "    positions = np.vstack([X.ravel(), Y.ravel()])  # Flatten grid\n",
    "    \n",
    "    # Evaluate KDEs on the grid\n",
    "    Z = kde(positions).reshape(X.shape)\n",
    "    FG=-np.log(Z.T) - np.min(-np.log(Z.T))\n",
    "    FG[FG>5]=np.nan\n",
    "    Zuw = kde_uw(positions).reshape(X.shape)\n",
    "    F=-np.log(Zuw.T) - np.min(-np.log(Zuw.T))\n",
    "    F[F>5]=np.nan\n",
    "\n",
    "  \n",
    "    # Plot KDE using imshow\n",
    "    #plt.subplot(1, 4, 3)\n",
    "    #plt.imshow(\n",
    "    #    FG.T,  \n",
    "    #    extent=[x_min, x_max, y_min, y_max],\n",
    "    #    origin='lower',\n",
    "    #    aspect='auto',\n",
    "    #    cmap='Spectral',\n",
    "    #    vmin=0,  # Set minimum color limit\n",
    "    #    vmax=5   # Set maximum color limit (adjust as needed)\n",
    "    #)\n",
    "    #plt.colorbar(label='$F(\\mathbf{s})$ [k$_B$T]')\n",
    "    #plt.title('$F_G(\\mathbf{s})$')\n",
    "    #plt.xlabel('$s_1$')\n",
    "    #plt.ylabel('$s_2$')\n",
    "\n",
    "     # Find local minima (neighborhood filtering)\n",
    "    local_minima_FG = (FG == ndimage.minimum_filter(FG, size=10))   \n",
    "    # Get the indices of the local minima\n",
    "    minima_indices = np.argwhere(local_minima_FG)\n",
    "    # Convert indices to coordinate space\n",
    "    minima_coords = np.array([\n",
    "        [x_grid[i], y_grid[j]] for i, j in minima_indices\n",
    "    ])\n",
    "    # Mark minima\n",
    "    #plt.scatter(minima_coords[:, 0], minima_coords[:, 1], color='Blue', marker='o', label='Local Minima')\n",
    "    deltas_FG.append(FG[local_minima_FG])\n",
    "      \n",
    "\n",
    "    # Plot KDE using imshow\n",
    "    #plt.subplot(1, 4, 4)\n",
    "    #plt.imshow(\n",
    "    #    F.T,  \n",
    "    #    extent=[x_min, x_max, y_min, y_max],\n",
    "    #    origin='lower',\n",
    "    #    aspect='auto',\n",
    "    #    cmap='Spectral',\n",
    "    #    vmin=0,  # Set minimum color limit\n",
    "    #    vmax=5   # Set maximum color limit (adjust as needed)\n",
    "    #)\n",
    "    #plt.colorbar(label='$F(\\mathbf{s})$ [k$_B$T]')\n",
    "    #plt.title('$F(\\mathbf{s})$')\n",
    "    #plt.xlabel('$s_1$')\n",
    "    #plt.ylabel('$s_2$')\n",
    "    \n",
    "     # Find local minima (neighborhood filtering)\n",
    "    local_minima_F = (F == ndimage.minimum_filter(F, size=10))   \n",
    "    # Get the indices of the local minima\n",
    "    minima_indices = np.argwhere(local_minima_F)\n",
    "    # Convert indices to coordinate space\n",
    "    minima_coords = np.array([\n",
    "        [x_grid[i], y_grid[j]] for i, j in minima_indices\n",
    "    ])\n",
    "    # Mark minima\n",
    "    #plt.scatter(minima_coords[:, 0], minima_coords[:, 1], color='Blue', marker='o', label='Local Minima')\n",
    "    deltas_F.append(F[local_minima_F])\n",
    "    \n",
    "    #plt.tight_layout()\n",
    "    \n",
    "    filename='model_'+str(niter)+'.png'\n",
    "    \n",
    "    ##plt.savefig(filename, dpi=300)\n",
    "    #plt.show()\n",
    "\n",
    "    \n",
    "    w_g=np.zeros(batch_size)\n",
    "    encoder.save(f'encoder_model_{niter}.h5')\n",
    "    niter=niter+1\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "fd0335b2-c3fd-461a-88ad-be035a6f0af5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 500x400 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot histogram\n",
    "all_deltaFs=[]\n",
    "for i in np.arange(0,99): \n",
    "    all_deltaFs.extend(np.sort(deltas_F[int(i)])[1:4])\n",
    "\n",
    "plt.hist(all_deltaFs, range=(0, 2), color=colors[19], bins=35, alpha=0.35, edgecolor='none',label='$\\Delta{F}$')\n",
    "plt.plot([np.mean(all_deltaFs),np.mean(all_deltaFs)],[0,60],'--',color=colors[19])\n",
    "\n",
    "all_deltaFGs=[]\n",
    "for i in np.arange(0,99): \n",
    "    all_deltaFGs.extend(np.sort(deltas_FG[int(i)])[1:4])\n",
    "\n",
    "plt.hist(all_deltaFGs, range=(0, 2), color=colors[1], bins=35, alpha=0.3, edgecolor='none',label='$\\Delta{F}_G$')\n",
    "plt.plot([np.mean(all_deltaFGs),np.mean(all_deltaFGs)],[0,60],'--',color=colors[1])\n",
    "plt.xlabel('$[k_BT]$')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "   \n",
    "plt.savefig(filename_test, dpi=300)\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fb50d549-552a-4ab7-82a4-e860a4815cb6",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
